<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TPU Add Course</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000000;
            min-height: 100vh;
            color: #fff;
        }

        .navbar {
            background: #0a0a0a;
            border-bottom: 1px solid #222;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.8);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-logo {
            width: 50px;
            height: 50px;
            background: #1a1a1a;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #333;
        }

        .nav-logo svg {
            width: 30px;
            height: 30px;
            fill: none;
            stroke: #888;
        }

        .nav-title h2 {
            color: #fff;
            font-size: 1.5rem;
        }

        .nav-title p {
            color: #666;
            font-size: 0.85rem;
        }

        .back-btn {
            padding: 10px 25px;
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 10px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-btn:hover {
            background: #222;
            border-color: #444;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(68, 68, 68, 0.4);
        }

        .back-btn svg {
            width: 18px;
            height: 18px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }

        .header-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
            border: 1px solid #333;
        }

        .header-icon svg {
            width: 45px;
            height: 45px;
            fill: none;
            stroke: #4A90E2;
        }

        .page-header h1 {
            color: #fff;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .page-header p {
            color: #888;
            font-size: 1.1rem;
        }

        .form-container {
            background: #0a0a0a;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.9);
            border: 1px solid #222;
            backdrop-filter: blur(10px);
            animation: fadeInUp 0.8s ease;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .section-title {
            color: #4A90E2;
            font-size: 1.2rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #222;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title svg {
            width: 24px;
            height: 24px;
            stroke: #4A90E2;
            fill: none;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #999;
            font-size: 0.9rem;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-wrapper {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            pointer-events: none;
        }

        .input-icon svg {
            width: 100%;
            height: 100%;
            stroke: #555;
            fill: none;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 14px 15px 14px 45px;
            background: #111;
            border: 2px solid #222;
            border-radius: 12px;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
            outline: none;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            border-color: #4A90E2;
            box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.2);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23888' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            padding-right: 45px;
        }

        .course-preview {
            background: linear-gradient(135deg, #1a1a1a 0%, #111 100%);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #333;
            margin-bottom: 30px;
        }

        .preview-title {
            color: #fff;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .preview-title svg {
            width: 20px;
            height: 20px;
            stroke: #50C878;
            fill: none;
        }

        .preview-content {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .preview-item {
            background: #0a0a0a;
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid #222;
        }

        .preview-label {
            color: #888;
            font-size: 0.85rem;
            margin-bottom: 5px;
        }

        .preview-value {
            color: #fff;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        .submit-btn {
            padding: 16px;
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            border: 2px solid #4A90E2;
            border-radius: 12px;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(74, 144, 226, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(74, 144, 226, 0.5);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn svg {
            width: 20px;
            height: 20px;
        }

        .cancel-btn {
            padding: 16px;
            background: transparent;
            border: 2px solid #444;
            border-radius: 12px;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cancel-btn:hover {
            background: #1a1a1a;
            border-color: #666;
            transform: translateY(-2px);
        }

        .cancel-btn:active {
            transform: translateY(0);
        }

        .help-text {
            color: #666;
            font-size: 0.85rem;
            margin-top: 5px;
            font-style: italic;
        }

        /* ===================== */
/*  REGISTERED COURSES   */
/* ===================== */

.registered-courses {
    margin-top: 50px;
    background: #0a0a0a;
    padding: 30px;
    border-radius: 20px;
    border: 1px solid #222;
    box-shadow: 0 20px 50px rgba(0,0,0,0.7);
    overflow-x: auto;
}

.course-table {
    width: 100%;
    min-width: 900px; /* Prevent squeezing */
    border-collapse: collapse;
    overflow: hidden;
}

.course-table th,
.course-table td {
    padding: 14px 18px;
    text-align: left;
    vertical-align: top;
}

.course-table th {
    background: #111;
    color: #4A90E2;
    font-weight: 600;
    border-bottom: 2px solid #222;
}

.course-table td {
    background: #0d0d0d;
    color: #e5e5e5;
    border-bottom: 1px solid #222;
}

.course-table tr:hover td {
    background: #171717;
    transition: 0.2s ease;
}

/* THEME A BADGES */
.badge {
    padding: 4px 10px;
    border-radius: 8px;
    color: #fff;
    font-size: 0.78rem;
    font-weight: 600;
    display: inline-block;
    margin: 2px 0;
}

.badge-blue    { background: #1e88e5; }
.badge-gray    { background: #424242; }
.badge-green   { background: #43a047; }
.badge-yellow  { background: #fbc02d; color: #000; }
.badge-purple  { background: #8e24aa; }
.badge-orange  { background: #fb8c00; }
.badge-id      { background: #546e7a; }

/* DELETE BUTTON */
.delete-btn {
    background: #b71c1c;
    padding: 10px;
    border-radius: 10px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: 0.25s;
    border: 2px solid #d32f2f;
}

.delete-btn:hover {
    background: #d32f2f;
    transform: scale(1.15);
    box-shadow: 0 0 12px rgba(255, 30, 30, 0.5);
}

.delete-icon {
    width: 22px;
    height: 22px;
    stroke: white;
    fill: none;
    stroke-width: 2px;
}

/* NO-DATA */
.no-data {
    text-align: center;
    padding: 20px;
    font-size: 1rem;
    color: #777;
    font-style: italic;
}



        
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <div class="nav-logo">
                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
                    <path d="M6 12v5c3 3 9 3 12 0v-5"></path>
                </svg>
            </div>
            <div class="nav-title">
                <h2>TPU University</h2>
                <p>Add New Course</p>
            </div>
        </div>
        <a href="{% url 'index'%}" style= "text-decoration:none; color:black">
        <button class="back-btn" onclick="goBack()">
            <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="currentColor">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
            Back to Dashboard
        </button>
    </a>
    </nav>

    <div class="container">
        <div class="page-header">
            <div class="header-icon">
                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
            </div>
            <h1>Add New Course</h1>
            <p>Enroll in a new course for the semester</p>
        </div>

        <div class="form-container">
            <form id="addCourseForm" method="POST" action="{% url 'add_course' %}">
                {% csrf_token %}
                <!-- Course Information Section -->
                <div class="form-section">
                    <div class="section-title">
                        <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                        </svg>
                        Course Information
                    </div>

                    <div class="form-row">

                        <div class="form-group">
                            <label for="course">Course</label>
                            <div class="input-wrapper">
                                <div class="input-icon">
                                    <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                                    </svg>
                                </div>
                                <select id="course" name="course" required onchange="autofillCourse()">
                                <option value="">Select Course</option>
                                {% for course in courses %}
                                <option value='{
                                    "department":"{{ course.department.DepName }}",
                                    "code":"{{ course.courseCode }}",
                                    "name":"{{ course.courseName }}",
                                    "lecturer":[{% for lec in course.lecturer.all %}"{{ lec.first_name }} {{ lec.last_name }}"{% if not forloop.last %},{% endif %}{% endfor %}],
                                    "credits":"{{ course.credits }}",
                                    "day":"{{ course.courseDay|upper }}",
                                    "time":"{{ course.courseTime }}"

                                }'>
                                    {{course.courseCode}} | {{course.courseName}}
                                </option>
                                {% endfor %}
                                    
                                </select>
                            </div>
                            <p class="help-text">Select a course to auto-fill details</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="courseCode">Course Code</label>
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="16 18 22 12 16 6"></polyline>
                                    <polyline points="8 6 2 12 8 18"></polyline>
                                </svg>
                            </div>
                            <input type="text" id="courseCode" name="courseCode" placeholder="e.g., CS301" required onchange="updatePreview()">
                            
                        </div>
                        <p class="help-text">Enter the official course code</p>
                    </div>



                    <div class="form-group">
                        <label for="courseName">Course Name</label>
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                                </svg>
                            </div>
                            <input type="text" id="courseName" name="courseName" placeholder="e.g., Data Structures & Algorithms" required onchange="updatePreview()">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="lecturer">Lecturer</label>
                            <div class="input-wrapper">
                                <div class="input-icon">
                                    <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="12" cy="7" r="4"></circle>
                                    </svg>
                                </div>
                                <input type="text" id="lecturer" name="lecturer" placeholder="e.g., Dr. Sarah Johnson" required onchange="updatePreview()">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="credits">Credits</label>
                            <div class="input-wrapper">
                                <div class="input-icon">
                                    <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                    </svg>
                                </div>
                                <input type="number" id="credits" name="credits" placeholder="e.g., 3" min="1" max="10" required onchange="updatePreview()">
                            </div>
                        </div>
                        
                    </div>
                </div>

                <!-- Schedule Section -->
                <div class="form-section">
                    <div class="section-title">
                        <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        Course Schedule
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="courseDay">Course Day</label>
                            <div class="input-wrapper">
                                <div class="input-icon">
                                    <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                        <line x1="16" y1="2" x2="16" y2="6"></line>
                                        <line x1="8" y1="2" x2="8" y2="6"></line>
                                        <line x1="3" y1="10" x2="21" y2="10"></line>
                                    </svg>
                                </div>
                                <input type="text" id="courseDay" name="courseDay" placeholder="e.g., Monday, Wednesday" required onchange="updatePreview()">
                            </div>
                            <p class="help-text">Enter the day(s) the course meets</p>
                        </div>

                        <div class="form-group">
                            <label for="courseTime">Course Time</label>
                            <div class="input-wrapper">
                                <div class="input-icon">
                                    <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12 6 12 12 16 14"></polyline>
                                    </svg>
                                </div>
                                <input type="text" id="courseTime" name="courseTime" placeholder="e.g., 10:00 AM - 12:00 PM" required onchange="updatePreview()">
                            </div>
                            <p class="help-text">Enter the time slot for the course</p>
                        </div>
                    </div>
                </div>

                <!-- Course Preview -->
                <div class="course-preview">
                    <div class="preview-title">
                        <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        Course Preview
                    </div>
                    <div class="preview-content">
                        <div class="preview-item">
                            <div class="preview-label">Course Code</div>
                            <div class="preview-value" id="previewCode">-</div>
                        </div>
                        <div class="preview-item">
                            <div class="preview-label">Course Name</div>
                            <div class="preview-value" id="previewName">-</div>
                        </div>
                        <div class="preview-item">
                            <div class="preview-label">Department</div>
                            <div class="preview-value" id="previewDepartment">-</div>
                        </div>
                        <div class="preview-item">
                            <div class="preview-label">Lecturer</div>
                            <div class="preview-value" id="previewLecturer">-</div>
                        </div>
                        <div class="preview-item">
                            <div class="preview-label">Schedule</div>
                            <div class="preview-value" id="previewSchedule">-</div>
                        </div>
                        <div class="preview-item">
                            <div class="preview-label">Credits</div>
                            <div class="preview-value" id="previewCredits">-</div>
                        </div>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="button-group">
                    <button type="button" class="cancel-btn" onclick="cancelForm()">Cancel</button>
                    <button type="submit" class="submit-btn">
                        <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="currentColor">
                            <polyline points="9 11 12 14 22 4"></polyline>
                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                        </svg>
                        Add Course
                    </button>
                </div>
            </form>
        </div>
        <!-- Registered Courses Table -->
<div class="registered-courses">
    <h2 class="table-title">Registered Courses</h2>

    <table class="course-table">
        <thead>
            <tr>
                <th>#</th>
                <th>Course</th>
                <th>Department</th>
                <th>Lecturer</th>
                <th>Schedule</th>
                <th>Credits</th>
                <th>Action</th>
            </tr>
        </thead>

        <tbody>
            {% for enroll in enrollment %}
            <tr class="course-row">
                <td>
                    <span class="badge badge-id">{{ forloop.counter }}</span>
                </td>

                <!-- Course Code + Course Name Badge -->
                <td>
                    <span class="badge badge-blue">{{ enroll.course.courseCode }}</span><br>
                    <span class="badge badge-gray">{{ enroll.course.courseName }}</span>
                </td>

                <!-- Department -->
                <td>
                    <span class="badge badge-green">{{ enroll.course.department.DepName }}</span>
                </td>

                <!-- Lecturers -->
                <td>
                    {% for lec in enroll.course.lecturer.all %}
                        <span class="badge badge-yellow">
                            {{ lec.first_name }} {{ lec.last_name }}
                        </span>
                    {% endfor %}
                </td>

                <!-- Schedule -->
                <td>
                    <span class="badge badge-purple">{{ enroll.course.courseDay|upper }}</span><br>
                    <span class="badge badge-purple">{{ enroll.course.courseTime }}</span>
                </td>

                <!-- Credits -->
                <td>
                    <span class="badge badge-orange">{{ enroll.course.credits }} Credits</span>
                </td>

                <!-- Delete Button -->
                <td>
                    <a href="{% url 'deleted' enroll.id%}" 
                       class="delete-btn"
                       onclick="return confirm('Are you sure you want to remove this course?');">
                        <svg viewBox="0 0 24 24" class="delete-icon">
                            <path d="M3 6h18"></path>
                            <path d="M8 6v14"></path>
                            <path d="M16 6v14"></path>
                            <path d="M5 6l1-3h12l1 3"></path>
                        </svg>
                    </a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="no-data">No courses registered yet</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

</div>

    </div>

    <script>

        function filterCourses() {
            const department = document.getElementById('department').value;
            const courseSelect = document.getElementById('course');
            
            // Clear existing options
            courseSelect.innerHTML = '<option value="">Select Course</option>';
            
            if (department && courseDatabase[department]) {
                // Add courses for selected department
                courseDatabase[department].forEach(course => {
                    const option = document.createElement('option');
                    option.value = JSON.stringify(course);
                    option.textContent = `${course.code} - ${course.name}`;
                    courseSelect.appendChild(option);
                });
            }
            
            updatePreview();
        }

        function autofillCourse() {
            const courseSelect = document.getElementById('course');
            
            if (courseSelect.value) {
                const courseData = JSON.parse(courseSelect.value);
                
                // Fill in all the fields
                document.getElementById('courseCode').value = courseData.code;
                document.getElementById('courseName').value = courseData.name;
                document.getElementById('lecturer').value = courseData.lecturer;
                document.getElementById('credits').value = courseData.credits;
                document.getElementById('courseDay').value = courseData.day;
                document.getElementById('courseTime').value = courseData.time;

                // Update preview section
                document.getElementById("previewCode").textContent = courseData.code;
                document.getElementById("previewName").textContent = courseData.name;
                document.getElementById("previewLecturer").textContent = courseData.lecturer;
                    document.getElementById("previewDepartment").textContent = courseData.department;
                document.getElementById("previewSchedule").textContent =
                    courseData.day + " " + courseData.time;
                document.getElementById("previewCredits").textContent =
                    courseData.credits + " Credits";

                
                // Update preview
                updatePreview();
            }
        }


        function cancelForm() {
            if (confirm('Are you sure you want to cancel? All entered data will be lost.')) {
                document.getElementById('addCourseForm').reset();
                updatePreview();
            }
        }

        function goBack() {
            if (confirm('Go back to dashboard?')) {
                // window.location.href = 'dashboard.html';
                alert('Navigating back to dashboard...');
            }
        }
    </script>
</body>
</html>